(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{168:function(e,t,n){},190:function(e,t,n){},192:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(0),o=n(44),i=n.n(o),a=n(10),s=n(23),l=n(12),u=(n(168),n(210)),b=Object(a.b)((function(e){return console.log("Notification - mapStateToProps",e),{notification:e.notification}}))((function(e){return e.notification.text?Object(r.jsx)(u.a,{positive:!e.notification.isError,error:e.notification.isError,children:e.notification.text}):null})),d=n(14),j=n(111),f=function(e){var t=Object(c.useState)(""),n=Object(j.a)(t,2),r=n[0],o=n[1];return{type:e,value:r,onChange:function(e){o(e.target.value)},reset:function(){o("")}}},g=n(207),O=n(193),h=n(15),x=n.n(h),p=n(32),v=n(36),m=n.n(v),y="/api/blogs",w=null,k=function(){return m.a.get(y).then((function(e){return e.data}))},E=function(e){var t={headers:{Authorization:w}};return console.log("Create",e,t),m.a.post(y,e,t).then((function(e){return e.data}))},L=function(e,t){return m.a.put("".concat(y,"/").concat(e),t).then((function(e){return e.data}))},I=function(e){var t={data:e,headers:{Authorization:w}};return console.log("Remove",e,t),m.a.delete("".concat(y,"/").concat(e.id),t).then((function(e){console.log(e.data)}))},B=function(e){w="bearer ".concat(e),console.log("blog service set token",w)},S=function(e,t){return m.a.post("".concat(y,"/").concat(e,"/comments"),{text:t}).then((function(e){return e.data}))},N=[],T=function(e){var t=e.title,n=e.author,r=e.url;return function(){var e=Object(p.a)(x.a.mark((function e(c){var o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E({title:t,author:n,url:r,likes:0});case 2:o=e.sent,c({type:"NEW_BLOG",data:o});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},_=function(e){return function(){var t=Object(p.a)(x.a.mark((function t(n){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L(e.id,e);case 2:n({type:"UPDATE_BLOG",data:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},U=function(e){var t=Object(d.a)(Object(d.a)({},e),{},{likes:e.likes+1});return _(t)},G=function(e){return function(){var t=Object(p.a)(x.a.mark((function t(n){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I(e);case 2:n({type:"REMOVE_BLOG",data:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(console.log("blogReducer",e,t),t.type){case"INIT_BLOGS":return console.log("INIT_BLOGS",e.concat(t.data)),t.data;case"NEW_BLOG":return console.log("NEW_BLOG",e.concat(t.data)),e.concat(t.data);case"UPDATE_BLOG":return console.log("UPDATE_BLOG",e.concat(t.data)),e.map((function(e){return e.id===t.data.id?t.data:e}));case"REMOVE_BLOG":return e.filter((function(e){return e.id!==t.data.id}));default:return e}},C={text:"",isError:!1},A=function(e,t,n){return function(r){r({type:"SET_NOTIF",data:{text:e,isError:t}}),setTimeout((function(){r(P())}),1e3*n)}},P=function(){return{type:"RESET_NOTIF"}},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(console.log("notificationReducer",e,t),t.type){case"SET_NOTIF":return t.data;case"RESET_NOTIF":return"";default:return e}},D={createBlog:T,setNotification:A},F=Object(a.b)((function(e){return{blogs:e.blogs,notification:e.notification}}),D)((function(e){var t=f("text"),n=f("text"),c=f("text"),o=Object(d.a)({},t);delete o.reset;var i=Object(d.a)({},n);delete i.reset;var a=Object(d.a)({},c);delete a.reset;return Object(r.jsx)("div",{children:Object(r.jsxs)(g.a,{onSubmit:function(r){r.preventDefault(),e.createBlog({title:t.value,author:n.value,url:c.value}),e.setNotification("blog ".concat(t.value," created"),!1,5),c.reset(),n.reset(),t.reset()},children:[Object(r.jsxs)(g.a.Field,{children:[Object(r.jsx)("label",{children:"Title"}),Object(r.jsx)("input",Object(d.a)({name:"title"},o))]}),Object(r.jsxs)(g.a.Field,{children:[Object(r.jsx)("label",{children:"Author"}),Object(r.jsx)("input",Object(d.a)({name:"author"},i))]}),Object(r.jsxs)(g.a.Field,{children:[Object(r.jsx)("label",{children:"URL"}),Object(r.jsx)("input",Object(d.a)({name:"url"},a))]}),Object(r.jsx)(O.a,{primary:!0,type:"submit",children:"create"})]})})})),W=function(e){var t=Object(c.useState)(!1),n=Object(j.a)(t,2),o=n[0],i=n[1],a={display:o?"none":""},s={display:o?"":"none"},l=function(){i(!o)};return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{style:a,children:Object(r.jsx)(O.a,{"data-cy":e.buttonLabel.replace(" ","-"),primary:!0,onClick:l,children:e.buttonLabel})}),Object(r.jsxs)("div",{style:s,children:[e.children,Object(r.jsx)(O.a,{"data-cy":"cancel",onClick:l,children:"cancel"})]})]})},J=(n(190),Object(a.b)((function(e,t){return{blog:t.blog}}),{})((function(e){return Object(r.jsx)("div",{className:"blog",children:Object(r.jsx)("div",{children:Object(r.jsxs)(s.b,{to:"/blogs/".concat(e.blog.id),children:[" ",e.blog.title," - ",e.blog.author]})})})}))),M=n(212),V=Object(a.b)((function(e){return{blogs:e.blogs}}),{})((function(e){return Object(r.jsxs)("div",{children:[Object(r.jsx)(M.a,{as:"h2",children:"Blogs"}),Object(r.jsx)(W,{buttonLabel:"new note",children:Object(r.jsx)(F,{})}),Object(r.jsx)("div",{children:e.blogs?e.blogs.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(r.jsx)(J,{blog:e},e.id)})):""})]})})),q=n(205),H={addComment:function(e,t){return function(){var n=Object(p.a)(x.a.mark((function n(r){var c;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S(e.id,t);case 2:c=n.sent,console.log("reducer addComment updatedBlog",t,c),r({type:"UPDATE_BLOG",data:c});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},K=Object(a.b)((function(e,t){return{blog:t.blog,notification:e.notification}}),H)((function(e){var t=f("text"),n=Object(d.a)({},t);delete n.reset;return Object(r.jsxs)("div",{children:[Object(r.jsx)(M.a,{as:"h3",children:"Comments"}),Object(r.jsxs)("div",{children:[Object(r.jsx)(q.a,Object(d.a)(Object(d.a)({name:"comment"},n),{},{"data-cy":"comment-field"})),Object(r.jsx)(O.a,{primary:!0,"data-cy":"add-comment-btn",onClick:function(n){n.preventDefault(),t.value&&(e.addComment(e.blog,t.value),t.reset())},children:"add"})]}),Object(r.jsx)("div",{children:Object(r.jsx)("ul",{children:e.blog.comments.map((function(e){return Object(r.jsx)("li",{children:e},e)}))})})]})})),Q=n(45),X=Object(l.f)((function(e){return e.blog?Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{children:[Object(r.jsxs)("h2",{children:[e.blog.title," - ",e.blog.author]}),Object(r.jsx)(O.a,{icon:!0,onClick:function(){window.confirm("Remove blog ".concat(e.blog.title,"?"))&&(e.removeBlog(e.blog),e.setNotification("blog ".concat(e.blog.title," removed"),!1,5),e.history.push("/"))},style:{display:e.blog.user&&e.login.username===e.blog.user.username?"":"none"},children:Object(r.jsx)(Q.a,{name:"trash"})})," "]}),Object(r.jsxs)("div",{children:["added by ",e.blog.user?e.blog.user.name:"unknown"]}),Object(r.jsxs)("div",{children:[e.blog.likes," likes",Object(r.jsx)(O.a,{icon:!0,"data-cy":"like-btn",onClick:function(){e.likeBlog(e.blog)},children:Object(r.jsx)(Q.a,{name:"like"})})]}),Object(r.jsx)("div",{children:Object(r.jsx)("a",{href:e.blog.url,children:e.blog.url})}),Object(r.jsx)("br",{}),Object(r.jsx)(K,{blog:e.blog})]}):null})),Y=function(e,t){return console.log("getBlog",e,t),e.blogs.find((function(e){return e.id===t.blogid}))},Z={likeBlog:U,removeBlog:G,setNotification:A},$=Object(a.b)((function(e,t){return{blog:Y(e,t),login:e.login,notification:e.notification}}),Z)(X),ee=Object(a.b)((function(e){return{users:e.users}}))((function(e){return Object(r.jsxs)("div",{children:[Object(r.jsx)(M.a,{as:"h2",children:"Users"}),Object(r.jsx)("table",{children:Object(r.jsxs)("tbody",{children:[Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{}),Object(r.jsx)("th",{children:"blogs created"})]}),e.users.map((function(e){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:Object(r.jsx)(s.b,{to:"/users/".concat(e.id),children:e.name})}),Object(r.jsx)("td",{children:e.blogs.length})]},e.username)}))]})})]})})),te=n(209),ne=function(e,t){return e.users.find((function(e){return e.id===t.userid}))},re=Object(a.b)((function(e,t){return{blogs:e.blogs,user:ne(e,t)}}))((function(e){return console.log("UserView props",e),void 0===e.user?null:(console.log("props.user",e.user),Object(r.jsxs)("div",{children:[Object(r.jsx)(M.a,{as:"h2",children:e.user.name}),Object(r.jsx)(M.a,{as:"h3",children:"Added blogs"}),Object(r.jsx)(te.a,{bulleted:!0,children:e.user.blogs.map((function(e){return Object(r.jsx)(te.a.Item,{children:Object(r.jsx)(s.b,{to:"/blogs/".concat(e.id),children:e.title})},e.id)}))})]}))})),ce=function(e){return function(t){B(e.token),t({type:"SET_LOGIN",data:e})}},oe=function(){return function(e){B(""),e({type:"RESET_LOGIN"})}},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOGIN":return t.data;case"RESET_LOGIN":return null;default:return e}},ae={login:function(){var e=Object(p.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},se=n(213),le=n(214),ue=Object(l.f)((function(e){var t=f("text"),n=f("password"),c=Object(d.a)({},t);delete c.reset;var o=Object(d.a)({},n);delete o.reset;var i=function(){var r=Object(p.a)(x.a.mark((function r(c){var o;return x.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c.preventDefault(),r.prev=1,console.log("handleLogin",t.value,n.value),r.next=5,ae.login({username:t.value,password:n.value});case 5:o=r.sent,console.log("loggedUser",o),o&&(window.localStorage.setItem("loggedUser",JSON.stringify(o)),e.setLogin(o),t.reset(),n.reset(),console.log("User logged in",t,n,e.login),e.history.push("/")),r.next=14;break;case 10:r.prev=10,r.t0=r.catch(1),console.log("handleLogin exception",r.t0),e.setNotification("Wrong username or password",!0,5);case 14:case"end":return r.stop()}}),r,null,[[1,10]])})));return function(e){return r.apply(this,arguments)}}();return Object(r.jsx)(se.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"top",children:Object(r.jsxs)(se.a.Column,{style:{maxWidth:450},children:[Object(r.jsx)(M.a,{as:"h2",textAlign:"center",children:" Login  "}),Object(r.jsx)(g.a,{size:"large",onSubmit:i,children:Object(r.jsxs)(le.a,{stacked:!0,children:[Object(r.jsx)(g.a.Input,Object(d.a)(Object(d.a)({fluid:!0,icon:"user",iconPosition:"left",name:"Username"},c),{},{"data-cy":"username"})),Object(r.jsx)(g.a.Input,Object(d.a)(Object(d.a)({fluid:!0,icon:"lock",iconPosition:"left",type:"password",name:"Password"},o),{},{"data-cy":"password"})),Object(r.jsx)(O.a,{fluid:!0,size:"large","data-cy":"submit",children:"Login"})]})})]})})})),be={setNotification:A,setLogin:ce},de=Object(a.b)((function(e){return{login:e.login,notification:e.notification}}),be)(ue),je=n(208),fe={resetLogin:oe},ge=Object(a.b)((function(e){return{login:e.login}}),fe)((function(e){console.log("props.login",e.login);return Object(r.jsxs)(je.a,{children:[Object(r.jsx)(je.a.Item,{children:Object(r.jsx)(s.b,{to:"/","data-cy":"blogs-link",children:"blogs"})}),Object(r.jsx)(je.a.Item,{children:Object(r.jsx)(s.b,{to:"/users","data-cy":"users-link",children:"users"})}),Object(r.jsx)(je.a.Menu,{position:"right",children:e.login?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(je.a.Item,{children:[" ",e.login.name.first," logged in"]}),Object(r.jsx)(je.a.Item,{children:Object(r.jsx)(O.a,{onClick:function(){window.localStorage.removeItem("loggedUser"),e.resetLogin()},children:"logout"})})]}):Object(r.jsx)(s.b,{to:"/login",children:"login"})})]})})),Oe="/api/users",he=function(){return m.a.get(Oe).then((function(e){return e.data}))},xe=[],pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,t=arguments.length>1?arguments[1]:void 0;switch(console.log("userReducer",e,t),t.type){case"INIT_USERS":return t.data;default:return e}},ve={initializeBlogs:function(){return function(){var e=Object(p.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},createBlog:T,updateBlog:_,likeBlog:U,removeBlog:G,initializeUsers:function(){return function(){var e=Object(p.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},setLogin:ce,resetLogin:oe,setNotification:A},me=Object(a.b)((function(e){return console.log("APP - mapStateToProps",e),{blogs:e.blogs,login:e.login,notification:e.notification}}),ve)((function(e){return Object(c.useEffect)((function(){var t=window.localStorage.getItem("loggedUser");if(t){console.log("load user",t);var n=JSON.parse(t);e.setLogin(n)}}),[]),Object(c.useEffect)((function(){console.log("get all blogs"),e.initializeBlogs(),e.initializeUsers()}),[]),console.log("check user",e.login),Object(r.jsx)("div",{children:Object(r.jsxs)(s.a,{children:[Object(r.jsx)(ge,{}),Object(r.jsx)(b,{}),"Some change for ex 11.22",Object(r.jsx)(l.b,{exact:!0,path:"/",render:function(){return e.login?Object(r.jsx)(V,{}):Object(r.jsx)(l.a,{to:"/login"})}}),Object(r.jsx)(l.b,{exact:!0,path:"/login",render:function(){return e.login?Object(r.jsx)(l.a,{to:"/"}):Object(r.jsx)(de,{})}}),Object(r.jsx)(l.b,{exact:!0,path:"/blogs/:id",render:function(e){var t=e.match;return Object(r.jsx)($,{blogid:t.params.id})}}),Object(r.jsx)(l.b,{exact:!0,path:"/users",render:function(){return e.login?Object(r.jsx)(ee,{}):Object(r.jsx)(l.a,{to:"/login"})}}),Object(r.jsx)(l.b,{exact:!0,path:"/users/:id",render:function(e){var t=e.match;return Object(r.jsx)(re,{userid:t.params.id})}})]})})})),ye=n(61),we=n(206),ke=n(145),Ee=n(146),Le=Object(ye.combineReducers)({notification:z,blogs:R,users:pe,login:ie}),Ie=Object(ye.createStore)(Le,Object(Ee.composeWithDevTools)(Object(ye.applyMiddleware)(ke.a)));i.a.render(Object(r.jsx)(a.a,{store:Ie,children:Object(r.jsx)(we.a,{children:Object(r.jsx)(me,{})})}),document.getElementById("root"))}},[[192,1,2]]]);
//# sourceMappingURL=main.6a3acbf8.chunk.js.map